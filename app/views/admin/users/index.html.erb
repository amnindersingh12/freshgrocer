<%# Admin Users Index %>
<div class="p-6">
  <div class="mb-8">
    <h1 class="text-3xl font-bold">Users</h1>
    <p class="text-gray-600 mt-2">Manage customer and admin accounts</p>
  </div>

  <div class="bg-white rounded-lg shadow-md overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Role</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Orders</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Joined</th>
          <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        <% @users.each do |user| %>
          <tr>
            <td class="px-6 py-4"><%= user.email %></td>
            <td class="px-6 py-4">
              <span class="px-3 py-1 <%= user.admin? ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800' %> text-xs font-medium rounded-full">
                <%= user.role.titleize %>
              </span>
            </td>
            <td class="px-6 py-4"><%= user.orders.count %></td>
            <td class="px-6 py-4 text-sm text-gray-600"><%= user.created_at.strftime('%b %d, %Y') %></td>
            <td class="px-6 py-4 text-right">
              <%= form_with model: [:admin, user], method: :patch, class: "inline" do |f| %>
                <%= f.select :role, User.roles.keys.map { |r| [r.titleize, r] }, {},
                    onchange: "this.form.requestSubmit()",
                    class: "text-sm border-gray-300 rounded" %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <%= paginate @users if @users.any? %>
</div>
